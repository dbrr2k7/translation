
{% extends "editor.html" %}

{% block translation_editor %}

    <div id="moratab1">
        <div id="moratab" style="white-space: pre-wrap">{{ trans }}</div>
    </div>


    <script type="text/javascript">

        document.online_prev = false;
        function online_preview() {
            if (document.online_prev == true){
                $('#original').css("direction","rtl");
                var mycontent = $('#moratab').text();
                $('#original').html(marked(mycontent));
                renderMathInElement(document.getElementById("original"));
            }
        }

        content = $('<textarea/>').html($('#moratab').html()).val();
        var editor = $('#moratab').moratab(content, {strings: {help: ''}});

        function send_data(quesId) {
            var mycontent = $('#moratab').text();
            $.ajax({
                url: " {% url 'saveQuestion' %}",
                data: {
                    'content': mycontent,
                    'id': quesId,
                    csrfmiddlewaretoken: '{{ csrf_token }}'
                },
                type: "POST",
                success: function (response) {
                },
                complete: function () {
                },
                error: function (xhr, textStatus, thrownError) {
                }
            });
            return false;
        }

        function changeEditorPreview(){
            var preview = document.getElementById("editor-checkbox").checked;
            if (preview) {
                var mycontent = $('#moratab').text();
                $('#katexTemp').html(marked(mycontent));
                renderMathInElement(document.getElementById("katexTemp1"));

                $('#moratab1').hide();
                $('#katexTemp1').show();
                document.getElementsByName("katexhtml").value = document.getElementById("katexTemp").innerHTML;
            }else {
                $('#moratab1').show();
                $('#katexTemp1').hide();
            }
        }

        var original_markdown = false;
        function changeOriginal(markdown){
            if(markdown){
                document.online_prev = false;
                window.setInterval(online_preview,100000);
                $('#original').css("direction","ltr");
                $('#original').html($('#myVar').text());

            }else{
                document.online_prev = false;
                window.setInterval(online_preview,100000);
                $('#original').css("direction","ltr");
                $('#original').html(marked($('#myVar').text()));
                renderMathInElement(document.getElementById("original"));
            }
        }

        function changeOriginalPreview(){
            var markdown = document.getElementById("original-checkbox").checked;
            original_markdown = markdown;
            changeOriginal(markdown);
        }

        function changeInteractive() {
            var interative = document.getElementById("interactive-checkbox").checked;
            if (interative) {
                document.online_prev = true;
                online_preview();
                window.setInterval(online_preview,1000);

            }else{
                changeOriginal(original_markdown);
            }
        }


        function save_version_particle() {
            var mycontent = $('#moratab').text();
            $.ajax({
                url: " {% url 'saveVersionParticle' %}",
                data: {
                    'content': mycontent,
                    'id': {{quesId}},
                    csrfmiddlewaretoken: '{{ csrf_token }}'
                },
                type: "POST",
                success: function (response) {
                },
                complete: function () {
                },
                error: function (xhr, textStatus, thrownError) {
                }
            });
            return false;

        }
        window.setInterval(save_version_particle,30000);
        window.setInterval(online_preview,100000);

    </script>

    <div  id="test"></div>

{% endblock %}