<!DOCTYPE html>
{% load staticfiles %}

<html>

<head>
    <title>IOI Translation</title>
    <meta charset="utf-8"/>
    <script type="text/javascript" src="/static/js/jquery-3.1.1.min.js"></script>
    <link rel="stylesheet" href="/static/css/bootstrap.min.css">
    <script type="text/javascript" src="/static/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/marked/0.3.6/marked.js"></script>
    <script src="/static/js/simplemde.min.js"></script>
    <script type="text/javascript" src="/static/editor/libs.js"></script>
    <script type="text/javascript" src="/static/editor/syntax.js"></script>
    <script type="text/javascript" src="/static/editor/buttons.js"></script>
    <script type="text/javascript" src="/static/editor/editor.js"></script>
    <link rel="stylesheet" href="/static/css/simplemde.min.css">
    <link type="text/css" rel="stylesheet" href="/static/editor/editor.css">


    <style type="text/css">
        body {
            background: #F5F5F5;
        }

        .container {
            max-width: 700px;
        }

        #moratab {
            margin-top: 20px;
        }

        @font-face {
            font-family: IRMitra;
            font-weight: normal;
            src: url('/static/style/IRMitra.woff') format('woff');
        }

        #wmd-input, .modal .btn, .modal p {
            font-family: IRMitra;
        }
    </style>


</head>
<body>

<div style="width: 100%">

       <button onclick="revert_version()" style="width:7%;margin-left: 30%; margin-top:1%">Revert Version</button>

        <div class="col-md-2" style="margin-top: 1%; float:left; position: relative; overflow-y: scroll; height:90vh">
            {% if versions %}
                <table class="table">
                    <thead >
                    <tr >
                        <th>Version</th>
                        <th>Date</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for version in versions %}
                        <tr class="version" id="{{ version.0 }}" style="cursor: pointer">
                            <td>{{ version.0 }}</td>
                            <td>{{ version.1 }}</td>
                        </tr>
                    {% endfor %}
                    {% for version in versionParticles %}
                        <tr class="versionparticle" id="{{ version.0 }}" style="cursor: pointer; background-color: yellow">
                            <td>{{ version.0 }}</td>
                            <td>{{ version.1 }}</td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            {% else %}
                <p style="text-align: left">No documents.</p>
            {% endif %}
        </div >
        <div class="col-md-10" style="width: 82%">

            <div style=" height: 400px; width:40%; margin-top: 0%; position: relative; float:left ; direction: rtl; padding-left: 3%; white-space:pre;">
                <div id="myversion"></div>
            </div>


            <div style=" height: 400px; width:40%; margin-top: 0%; position: relative; float:left ; direction: rtl; padding-left: 3%;white-space:pre;">
                <div id="original">{{ translation }}</div>
            </div>
        </div>

</div>



        <script type="text/javascript">
            var cur_ver_text = '';
            $(document).ready(function () {
                var cont = $('#original').text();
                $('#original').html(marked(cont));
                console.log('im heere')
            });

            function revert_version() {
                var mycontent = cur_ver_text;
                $.ajax({
                    url: " {% url 'saveQuestion' %}",
                    data: {
                        'content': mycontent,
                        'id': {{ quesId }},
                        csrfmiddlewaretoken: '{{ csrf_token }}'
                    },
                    type: "POST",
                    success: function (response) {
                        location.reload();
                    },
                    complete: function () {
                    },
                    error: function (xhr, textStatus, thrownError) {
                    }
                });
                return false;
            }

            $('.version').on('click', function (event) {
                event.preventDefault();
                console.log($(this).attr('id'));
                var content = "";
                $.ajax({
                    url: " {% url 'getVersion' %}",
                    data: {
                        'id': $(this).attr('id'),
                        csrfmiddlewaretoken: '{{ csrf_token }}'
                    },
                    type: "POST",
                    success: function (response) {
                        cur_ver_text = response;
                        $('#myversion').html(marked(response));
                    },
                    complete: function () {
                    },
                    error: function (xhr, textStatus, thrownError) {
                    }
                });

            })
            $('.versionparticle').on('click', function (event) {
                event.preventDefault();
                console.log($(this).attr('id'));
                var content = "";
                $.ajax({
                    url: " {% url 'getVersionParticle' %}",
                    data: {
                        'id': $(this).attr('id'),
                        csrfmiddlewaretoken: '{{ csrf_token }}'
                    },
                    type: "POST",
                    success: function (response) {
                        cur_ver_text = response;
                        $('#myversion').html(marked(response));
                    },
                    complete: function () {
                    },
                    error: function (xhr, textStatus, thrownError) {
                    }
                });

            })

        </script>

</body>
</html>
